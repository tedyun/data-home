/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","knockout","ojs/ojknockout","ojs/ojmessaging"],function(b,f,a){b.Jb=function(){this.Init()};o_("InvalidComponentTracker",b.Jb,b);b.b.ga(b.Jb,b.b,"oj.InvalidComponentTracker");b.Jb.wl="messagesShown";b.Jb.vn="messagesHidden";b.Jb.un="disabled";b.Jb.Iv="readOnly";b.Jb.prototype.Init=function(){b.Jb.q.Init.call(this);this.ku=[];this.Zn=[];this.Dt=[];this.invalidHidden=this.invalidShown=!1};b.Jb.prototype.E2=function(){var a=null,b=this,e=this.AD;this.invalidShown&&(a=this.cJ());
setTimeout(function(){(a=e===b.AD?a||b.cJ():b.cJ())&&a.call(a,"Focus")},1);return a?!0:!1};b.b.g("InvalidComponentTracker.prototype.focusOnFirstInvalid",{E2:b.Jb.prototype.E2});b.Jb.prototype.showMessages=function(){var a,b,e;if(this.invalidHidden)for(b=this.Dt.length,e=0;e<b;e++)this.Dt[e]&&(a=this.ku[e].call(a,"showMessages"))};b.b.g("InvalidComponentTracker.prototype.showMessages",{showMessages:b.Jb.prototype.showMessages});b.Jb.prototype.cJ=function(){for(var a,b=0,e=this.Zn.length,b=0;b<e;b++)if(a=
this.Zn[b])return this.ku[b];return null};b.Jb.prototype.sL=function(a){var b=-1,e=!1;f.each(this.ku,function(e,f){0>b&&f===a&&(b=e)});0<=b&&(this.ku.splice(b,1),this.Zn.splice(b,1),this.Dt.splice(b,1),this.RM(),e=!0);return e};b.Jb.prototype.wo=function(a,c,e){var g=a.call(a,"isValid"),h=-1,k=!0,l;f.each(this.ku,function(b,c){0>h&&c===a&&(h=b)});switch(c){case b.Jb.wl:case b.Jb.vn:l=!1;e&&(0>h&&(h=this.ku.push(a)-1,this.Qga(h,l)),!g&&b.Jb.hK(e)&&(l=!0,c===b.Jb.wl&&(e=a.call(a,"option",b.Jb.un),g=
a.call(a,"option",b.Jb.Iv),l=e||g?!1:!0)),k=this.iy(c,h||0,l),this.RM(),k&&(void 0===this.AD&&(this.AD=0),this.AD++));break;case b.Jb.un:case b.Jb.Iv:k=!1,e&&(k=this.iy(b.Jb.wl,h||0,!1),k=this.iy(b.Jb.vn,h||0,!1)||k,this.RM())}return k};b.Jb.prototype.Qga=function(a,c){void 0===this.Zn[a]&&this.iy(b.Jb.wl,a,c);void 0===this.Dt[a]&&this.iy(b.Jb.vn,a,c)};b.Jb.prototype.RM=function(){this.invalidShown=0<=this.Zn.indexOf(!0);this.invalidHidden=0<=this.Dt.indexOf(!0)};b.Jb.prototype.iy=function(a,c,e){var g=
!1;a=a===b.Jb.wl?this.Zn:a===b.Jb.vn?this.Dt:[];0<=c&&void 0!==a[c]?(g=a[c]!==e?!0:!1)&&a.splice(c,1,e):(a.push(e),g=!0);return g};b.Jb.hK=function(a){return!b.X.isValid(a)};b.Bb=function(){};b.Bb.zv="invalidComponentTracker";b.Bb.oR="ojoptionchange";b.Bb.wl="messagesShown";b.Bb.vn="messagesHidden";b.Bb.un="disabled";b.Bb.Iv="readOnly";b.Bb.wo=function(d,c,e,g,f){e={};f=f.call()[b.Bb.zv];var k;if(d===b.Bb.un||d===b.Bb.Iv)return k=f&&f.peek()||null,null!==k&&a.isWriteableObservable(f)&&k.wo.call(k,
g,d,c)&&f.valueHasMutated(),e[d]=c,e};b.Bb._init=function(a,b){var e={};e[a]=b;return e};b.Bb.y$=function(a,c,e,g){g=g.call();var f;a===b.Bb.zv&&(f=g[a]?!0:!1)&&b.Bb.Dja(a,g,c,e);return{}};b.Bb.Y$=function(d,c,e,g){c=f(c);g=g.call()[d];d===b.Bb.zv&&c&&(c.off(b.Bb.oR,b.Bb.s1),g&&a.isWriteableObservable(g)&&(d=g.peek(),d.sL.call(d,e)&&g.valueHasMutated()))};b.Bb.s1=function(d,c){var e=d.data.rP,g,f=d.data.O,k=c.option,l=c.value;(k===b.Bb.wl||k===b.Bb.vn)&&e&&a.isWriteableObservable(e)&&(g=e.peek())&&
g.wo.call(g,f,k,l)&&e.valueHasMutated()};b.Bb.Dja=function(d,c,e,g){d=c[d];var h,k;e=f(e);if(a.isObservable(d))k=d.peek(),null==k&&(k=new b.Jb,d(k));else throw Error("Binding attribute "+b.Bb.zv+" should be bound to a ko observable.");null!==k&&(a.isWriteableObservable(d)&&(c=g.call(g,"option",b.Bb.wl),h=g.call(g,"option",b.Bb.vn),k.wo.call(k,g,b.Bb.wl,c),k.wo.call(k,g,b.Bb.vn,h),d.valueHasMutated()),g={rP:d,O:g},e.on(b.Bb.oR,g,b.Bb.s1))};b.ia.Of().Vf({"for":"editableValue",attributes:[b.Bb.zv,b.Bb.un,
b.Bb.Iv],init:b.Bb._init,update:b.Bb.wo,afterCreate:b.Bb.y$,beforeDestroy:b.Bb.Y$})});