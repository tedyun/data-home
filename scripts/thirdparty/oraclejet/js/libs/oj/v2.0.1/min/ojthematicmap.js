/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","ojs/ojdvt-base","ojs/internal-deps/dvt/DvtThematicMap"],function(b,f,a,d,c){b.ya("oj.ojThematicMap",f.oj.dvtBaseComponent,{widgetEventPrefix:"oj",options:{load:null,optionChange:null},FU:"",BC:[],V0:{ar:"ar",cs:"cs",da:"da",de:"de",el:"el",es:"es",fi:"fi",fr:"fr","fr-ca":"fr_CA",he:"iw",hu:"hu",it:"it",ja:"ja",ko:"ko",nl:"nl",no:"no",pl:"pl",pt:"pt_BR","pt-pt":"pt",ro:"ro",ru:"ru",sk:"sk",sv:"sv",th:"th",tr:"tr","zh-hans":"zh_CN","zh-hant":"zh_TW"},
_ComponentCreate:function(){this._super();this.Tp=[];this.bY=!1;this.Us=[]},pf:function(a,b,d){return c.ThematicMap.newInstance(a,b,d)},ei:function(a){var b=a.subId;"oj-thematicmap-area"==b?b=a.dataLayer+":area["+a.index+"]":"oj-thematicmap-marker"==b?b=a.dataLayer+":marker["+a.index+"]":"oj-thematicmap-tooltip"==b&&(b="tooltip");return b},ig:function(a){var b={};0<a.indexOf(":area")?(b.subId="oj-thematicmap-area",b.dataLayer=a.substring(0,a.indexOf(":")),b.index=this.Wg(a)):0<a.indexOf(":marker")?
(b.subId="oj-thematicmap-marker",b.dataLayer=a.substring(0,a.indexOf(":")),b.index=this.Wg(a)):"tooltip"==a&&(b.subId="oj-thematicmap-tooltip");return b},Fe:function(){var a=this._super();a.push("oj-thematicmap");return a},gi:function(){var a=this._super();a["oj-dvtbase oj-thematicmap"]={path:"animationDuration",property:"animation-duration"};a["oj-thematicmap-arealayer"]=[{path:"styleDefaults/areaStyle",property:"CSS_BACKGROUND_PROPERTIES"},{path:"styleDefaults/labelStyle",property:"CSS_TEXT_PROPERTIES"}];
a["oj-thematicmap-area"]={path:"styleDefaults/dataAreaDefaults/borderColor",property:"border-top-color"};a["oj-thematicmap-area oj-hover"]={path:"styleDefaults/dataAreaDefaults/hoverColor",property:"border-top-color"};a["oj-thematicmap-area oj-selected"]=[{path:"styleDefaults/dataAreaDefaults/selectedInnerColor",property:"border-top-color"},{path:"styleDefaults/dataAreaDefaults/selectedOuterColor",property:"border-bottom-color"}];a["oj-thematicmap-marker"]=[{path:"styleDefaults/dataMarkerDefaults/labelStyle",
property:"CSS_TEXT_PROPERTIES"},{path:"styleDefaults/dataMarkerDefaults/color",property:"background-color"},{path:"styleDefaults/dataMarkerDefaults/opacity",property:"opacity"},{path:"styleDefaults/dataMarkerDefaults/borderColor",property:"border-top-color"}];return a},ii:function(){return["load","optionChange"]},_setOptions:function(a,c){var d=Object.keys(a).length,f=a.areaLayers,l=this.options.areaLayers,m=a.pointDataLayers;if(1==d&&f&&l&&0<l.length)for(d=0;d<f.length;d++){var m=f[d],n=l[d],p=!0,
r;for(r in m)"areaDataLayer"!=r&&m[r]!=n[r]&&(p=p&&!1);p&&!b.b.nh(n.areaDataLayer,m.areaDataLayer)&&this.Us.push({options:m.areaDataLayer,parentLayer:m.layer,isADL:!0})}else if(1==d&&m&&this.options.pointDataLayers&&0<this.options.pointDataLayers.length)for(d=0;d<m.length;d++)b.b.nh(this.options.pointDataLayers[d],m[d])||this.Us.push({options:m[d],parentLayer:m[d].id,isADL:!1});this._super(a,c)},kg:function(){this.Gha();for(var a=0;a<this.Tp.length;a++)if(!this.BC[this.Tp[a]])return;this.Tp=[];this.xma();
var c=this.options.tooltip;c&&(this.options._tooltip=function(a){var d=a.tooltip;try{return c(a)||d}catch(e){return b.r.warn("Showing default tooltip. "+e),d}});var d=this.options.areaLayers;if(d)for(a=0;a<d.length;a++){var f=d[a].areaDataLayer;if(f){var l=f._templateRenderer;l&&(f.renderer=this.$B(l,f.markers))}}if(d=this.options.pointDataLayers)for(a=0;a<d.length;a++)(f=d[a])&&(l=f._templateRenderer)&&(f.renderer=this.$B(l,f.markers));this.options._contextHandler=this.WI();if(this.bY&&0<this.Us.length){if(this.zf.isReadyToRender()){for(a=
0;a<this.Us.length;a++)l=this.Us[a],this.la.updateLayer(l.options,l.parentLayer,l.isADL);this.Us=[]}}else this._super(),this.bY=!0;this._trigger("load",null,null)},$B:function(a){var b=this;return function(c){var d=document.createElement("div");d.style.display="none";d.zI=b.zf;b.element.append(d);a({parentElement:d,data:c.data});return(c=d.children[0])?"http://www.w3.org/2000/svg"===c.namespaceURI?(d.removeChild(c),f(d).remove(),c):b.Fv(c):null}},WI:function(){var a=this;return function(c,d,f,l,m){return{component:b.Components.Rf(a.element),
parentElement:c,rootElement:d,data:f,state:l,previousState:m,id:f.id,label:f.label,color:f.color,location:f.location,x:f.x,y:f.y}}},renderDefaultHover:function(a){a.previousState&&a.state.hovered==a.previousState.hovered||this.la.processDefaultHoverEffect(a.id,a.state.hovered)},renderDefaultSelection:function(a){a.previousState&&a.state.selected==a.previousState.selected||this.la.processDefaultSelectionEffect(a.id,a.state.selected)},renderDefaultFocus:function(a){a.previousState&&a.state.focused==
a.previousState.focused||this.la.processDefaultFocusEffect(a.id,a.state.focused)},Gha:function(){var a=this.options.basemap;if(a){var c=b.ba.Bg();c!==this.FU&&(this.FU=c,this.BC=[]);var a=a.charAt(0).toUpperCase()+a.slice(1),d=this.options.areaLayers;if(d)for(var f=0;f<d.length;f++){var l=d[f].layer;l&&(l=l.charAt(0).toUpperCase()+l.slice(1),this.RY(a,l,c))}(d=this.options.pointDataLayers)&&0<d.length&&this.RY(a,"Cities",c)}},UY:function(a){if(!this.BC[a]){var c=b.ba.kb(a),d=this,k=this.BC;f.getScript(c,
function(){k[a]=!0;d.kg()})}},RY:function(a,b,c){var d="resources/internal-deps/dvt/thematicMap/basemaps/DvtBaseMap"+a+b+".js";-1==this.Tp.indexOf(d)&&(this.Tp.push(d),this.UY(d));if(-1===c.indexOf("en"))for(d=c.toLowerCase().split("-"),c=[d[0]],1<d.length&&c.unshift(d[0]+"-"+d[1]),2<d.length&&c.unshift(d[0]+"-"+d[2],d[0]+"-"+d[1]+"-"+d[2]),a="resources/internal-deps/dvt/thematicMap/resourceBundles/"+a+b+"Bundle",b=0;b<c.length;b++)if(this.V0[c[b]]){a=a+"_"+this.V0[c[b]]+".js";-1==this.Tp.indexOf(a)&&
(this.Tp.push(a),this.UY(a));break}},ck:function(a){if("selection"===a.type){var b={},c=a.clientId;b[c]=a.selection;if(this.options.selection)for(var d in this.options.selection)c!==d&&(b[d]=this.options.selection[d]);this.vd("selection",b)}else this._super(a)},ji:function(){var a=this.options.translations,b=this._super();b["DvtUtilBundle.THEMATIC_MAP"]=a.componentName;return b},xma:function(){var a=this.options.selection;if(a){var b=this.options.pointDataLayers;if(b)for(var c=0;c<b.length;c++)a[b[c].id]&&
(b[c].selection=a[b[c].id]);if(b=this.options.areaLayers)for(c=0;c<b.length;c++){var d=b[c].areaDataLayer;d&&a[d.id]&&(d.selection=a[d.id])}}},getArea:function(a,b){var c=this.la.getAutomation().getData(a,"area",b);this.Vg(c);return c},getMarker:function(a,b){var c=this.la.getAutomation().getData(a,"marker",b);this.Vg(c);return c},getContextByNode:function(a){return(a=this.getSubIdByNode(a))&&"oj-thematicmap-tooltip"!==a.subId?a:null},hi:function(){return{areaLayers:["areaDataLayer/areas","areaDataLayer/markers"],
pointDataLayers:["markers"]}},rR:function(a){var b=this.options.basemap;a=a.layer?a.layer:"cities";return{basemap:b,layer:a,ids:c.DvtBaseMapManager.getLayerIds(b,a)}}})});